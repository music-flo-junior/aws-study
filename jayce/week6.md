# AWS IAM
AWS IAM은 AWS 클라우드 인프라에서 신분 및 접속 관리 서비스로 사용자와 사용자 그룹이 보안이 유지된 상태에서 AWS 리소스에 접근할 수 있도록 해준다.

### 신분 인증

#### 유저 및 접근 권한 관리
클라우드 유저를 생성하고 액세스 키, 패스워드 등 보안 수단을 관리할 수 있다. 

#### 그룹화된 유저 및 접근 권한 권리
그룹화를 이용해서 AWS 리소스에 접근할 수 있는 싱글 사인온(SSO) 방식으로 기업 디렉터리에 접근 하도록 할 수 있다. AWS는 인증 정보 제공자(IdP)와 애플리케이션이 신분 인증 및 보안 정보를 교환할 수 있도록 보 안 추가 마크업 언어인 SAML 방식을 지원하고, 마이크로소프트 액티브 디렉터리를 위한 AWS 디렉터리서비스 등 비 SAML 방식도
지원한다.

### 권한 부여
AWS에서는 IAM 정책 방식으로 권한을 부여한다. IAM 정책은 JSON으로 작성된 하나 혹은 그 이상의 접근 승인 규칙을 담고 있다. 
승인 규칙은 특정 IAM 엔티티가 어떤 리소스에 대해 어떤 작업을 수행할 수 있는지 정의한다. 여기서의 특징은 IAM 유저를 생성하면 모든 리소스의 접근에 대한 기본 설정은 거부이며, 특정 리소스에 대해 명시적으로 허용 여부를 표시해 줘야 한다.

### 감사
AWS는 클라우드 업무 감사 도구를 제공하는데, 이는 중요 자원에 대해 적정한 권한이 있는 사람이 규칙 및 규정에 맞게 접근을 요청하고 작업을 진행했는지 확인하고 증빙하는 작업을 말한다

#### AWS CloudTrail
AWS CloudTrail은 계정에서 일어나는 일을 기록하고 이에 대한 로그 파일을 Amazone S3 버킷에 저장한다. 콘솔,CLI 등을 이용해서 로그 파일에 접근할 수 있고, 널리 사용되는 분석 도구로 로그 데이터를 분석할 수 있다.

##### CloudTrail이 기록하는 주요 행동
- 작업을 요청한 유저는 누구인가?
- 작업이 요청된 시간은 언제인가?
- 요청된 작업의 내용은 무엇인가?
- 요청된 작업으로 제공된 리소스는 어떤 것인가?
- 요청이 발송된 장소와 도달한 장소는 어디인가?

### 보안 자격 정보의 유형
- IAM 유저네임과 패스워드
- E-mail 주소와 패스워드
- 엑세스 키
- 키 페어
- 멀티 팩터 인증

### 임시 보안 자격 정보
AWS는 단기간만 사용할 목적으로 사용되는 임시 보안 자격 정보를 제공한다. 예를 들어, API를 통해 임시 보안 자격 정보를 사용할 때 유효 기간이 만료되면 해당 API를 AWS에서 사용 할 수 없다.

### 유저
AWS 계정을 처음 생성하면 AWS 루트 계정을 보유하게 되는데 이는 모든 리소스의 무제한의 접근 권한을 의미한다. 루트 계정은 안전하게 관리 해야 하므로 루트 계정으로 IAM 계정을 생성하고 풀 엑세스 권한을 부여해 사용하는 것이 좋다. 즉 루트 계정은 사용하지 않는 것이 좋다.

#### IAM을 통한 유저 생성 방법
1. IAM에서 유저 생성
2. 유저에 보안 자격 증명 부여
3. 유저에 접근 승인, 역할, 책임 부여
4. 유저를 하나 혹은 다수의 그룹에 추가

### 그룹
IAM 그룹을 만들어 사용하면 특정 그룹에 추가하는 동작만으로 동일한 역할을 상속 받을 수 있다.

#### IAM 그룹의 특징
- 그룹은 다수의 역할과 권한으로 구성되고 IAM을 이용해 승인
- 그룹에 추가된 유저는 그룹에 정의된 역할과 권한을 상속
- 그룹에 다수의 유저 추가 가능
- 하나의 유저가 다수의 그룹에 포함될 수 있음
- 단, 하나의 그룹을 다른 그룹에 추가할 수는 없고 그룹에는 오직 유저만 추가 가능
- AWS 계정의 모든 유저를 포함한 기본 그룹이 자동으로 생성되지는 않으며, 그룹을 생성해서 모든 유저를 추가할 수 있음

### 룰
IAM 그룹의 경우 영구적인 신분을 보유하지 않기 때문에 롤을 생성해 승인권을 관리한다

#### AWS 사용자 타입
- 영구적인 신분을 보유한 IAM 유저
- 영구적인 신부을 보유하지 않은 IAM 그룹

#### IAM 롤의 주요 활용 방식
- AWS 리소스에 접근하지 않는 유저, 애플리케이션, 서비스의 접근 대행
- 앱 내부에 AWS 키를 임베드하길 원치 않는 경우
- AWS 외부에서 이미 본인의 신분을 확인시켜준 사용자에게 AWS 접근권한을 부여하려는 경우
- 제 3자에게 계정에 대한 접근권한을 부여하려는 경우
- 특정 애플리케이션이 이미 다른 AWS 서비스를 사용할 수 있는 경우
- 특정 임무만을 수행하기 위해 임시 보안 승인 정보를 요청하는 경우

#### 롤 생성 방법
롤을 생성하려면 두 개의 정책을 작성해야 한다.
1. "누가 역할을 맡을 것인가?" 를 선택하는 신뢰 정책 설정
2. "어떤 리소스 혹은 액션을 접근하게 할 것인가?" 를 선택하는 접근 권한 정책 설정

### IAM 권한의 계층
1. AWS 루트 유저 또는 계정 소유자 
2. AWS IAM 유저
3. 임시 보안 자격 정보 보유자

### AWS 보안 규정 프로그램
AWS 보안 규정 프로그램은 고객으로 하여금 AWS 클라우드 내에서 보안 유지 및 데이터 보호가 어떻게 이뤄지는지 잘 이해할 수 있도록 해준다.
이 프로그램은 AWS 클라우드 인프라 위에 마련돼 있으며, 보안 규정에 따른 책임이 효과적으로 공유될 수 있다.

### AWS 공유 책임 모델
AWS는 클라우드 환경을 구성하는 인프라에 대한 보안을 책임지고, 기업은 클라우드에 저장한것 혹은 클라우드에 연결한 것에 대한 보안을 책임지게 된다.

#### 보안에 대한 AWS측의 책임
- 데이터 센터에 대한 물리적 보안
- Amazon EC2 보안
- 네트워크 보안
- 환경 설정 관리
- 고가용성 데이터 센터
- 디스크 관리
- 스토리지 디바이스 폐기

#### 보안에 대한 고객측의 책임
- 운영체제
- 애플리케이션
- 방화벽
- 네트워크 환경 설정
- 서비스 환경 설정
- 자격 인증 및 계정 관리