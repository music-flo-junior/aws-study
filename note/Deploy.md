# AWS 공인 솔루션스 아키텍트 올인원 어소시에이트

## 7장. AWS 애플리케이션 배포 및 모니터링

### AWS Lambda

AWS Lambda에 백엔드 코드를 업로드하면, 코드 실행에 필요한 용량 및 확장성 관리, 패치 업무, 인프라 관리 업무 등 제반 서버 관련 업무를 처리하며, 
처리 결과로 생성된 성능 지표는 실시간으로 CloudWatch에 전송하므로 개발자는 오직 코드 작성 업무에만 집중할 수 있다.

AWS Lambda는 초기 설치비 부담이 없는 저비용 서비스이며 사용자는 코드 실행 요청별 및 코드 실행 시간별로 부과되는 비용만 부담하면 된다.

AWS Lambda를 시작하기 위해 새로운 언어나 도구, 프레임워크를 학습할 필요가 없으며, 개발자에게 익숙한 서드 파티 라이브러리 또는 네이티브 도구를 그대로 사용할 수 있다.

AWS Lambda에서 실행되는 코드를 Lambda 함수라 부르며, 개발자는 자신이 작성한 코드를 ZIP 파일 형식으로 업로드하거나 AWS 관리 콘솔에 자신만의 통합 개발 환경을 구축할 수 있다.
또한 이미지 변환, 파일 압축, 변경 알림 등 다양한 Lambda 함수 샘플을 이용해 개발 시간을 줄이고 목표한 코드를 신속하게 업로드 할 수 있으며, AWS SDK를 이용해 간편하게 다른 AWS 서비스를 호출할 수 있다.

예를들어,

Lambda 함수를 업로드 한 뒤에 S3 버킷 또는 DynamoDB 테이블 등을 모니터링할 수 있는 이벤트 소스를 선택하면, 이벤트 발생 시 자동으로 해당 함수가 실행된다.
Lambda를 이용하면 여려분이 작성한 함수로 모든 이벤트를 발생시킬 수 있으며, 새로운 정보에 즉각적으로 반응하는 애플리케이션을 간편하게 구현할 수 있다.


### AWS Lambda는 진정한 서버리스 서비스인가?

AWS Lambda는 컴퓨팅 서비스로 가장 큰 장점은 서버 인프라 프로비전 및 관리 필요성이 없다는 것이다.

AWS Lambda는 서버리스 서비스이며, 특정 플랫폼이 서버리스로 인정받을려면 다음과 같은 조건을 갖춰야 한다.

1. 인프라 관리 필요성 없음

서버리스라는 단어 속에 관리 대상으로서의 서버 인프라가 없다는 의미 포함

2. 확장성

서버리스 플랫폼에서 언제든 애플리케이션의 스케일업 또는 스케일다운이 가능해야 함

3. 내재된 중복 구현성

서버리스 플랫폼은 항상 고가용성을 유지할 수 있어야함

4. 사용량에 따른 과금

서버리스 플랫폼에서 사용자는 자신이 사용한 서비스에 대한 비용만 부담하며, 서비스를 사용하지 않을 경우 비용이 부과되지 않음

Lambda 사용 시 코드가 실행될 때만 비용이 부과되며 코드가 실행되지 않으면 부과되는 비용 또한 없음.

또한 사용자는 서버 자체에 대한 비용은 물론 데이터 센터 운영에 소요되는 전기, 냉각, 네트워킹, 건축 비용 등 서버 실행과 관련된 비용도 부담하지 않아도 됨

AWS의 주요 서버리스 서비스는 다음과 같다.

1. Amazon S3
2. Amazon DynamoDB
3. Amazon API Gateway
4. AWS Lambda
5. Amazon SNS and SQS
6. Amazon CloudWatch Events
7. Amazon Kinesis

> AWS 에서 서버리스란?

진짜로 서버 없이 제공되는 서비스가 아니며, AWS는 서버리스 서비스를 제공하기 위해 대규모의 EC2 서버 플릿 또는 서버 함대를 보유 및 운용 중이다.
서버리스라는 단어가 사용되는 이유는 개발자가 부담해야 할 프로비저닝, 유지보수, 안정화 관리, 장애대응 등 다양한 업무 대상이 되는 서버가 없다는 뜻이며,
이 모든 업무를 서버리스 플랫폼인 AWS가 담당한다.

### AWS Lambda의 개요

사용자는 Lambda를 이용해 거의 모든 타입의 애플리케이션과 백엔드 서비스를 위한 코드를 실행할 수 있으며, 고가용성하에서 코드 실행 및 확장성을 유지할 수 있다.

각각의 Lambda 함수에는 실행하려는 코드가 들어있으며, 코드 실행 방식을 정의하는 환경 설정을 통해 코드를 실행하거나 함수의 실행을 촉발시키는 이벤트 소스를 감지할 수 있다.

> AWS Lambda 아키텍처

이벤트 환경을 설정한 뒤 이벤트가 발생하면 거의 즉각적으로 코드가 호출된다. 이때 코드는 비즈니스 로직을 포함해 어떤 것이든 가능하다. 

사용자는 다수의 Lambda 함수를 병렬적으로 실행할 수 있으며, 일정 시점에 실행할 수 있는 Lambda 함수의 개수 제한은 없다.

Lambda 함수는 상태 정보를 저장하지 않는 스테이트리스(stateless) 속성을 지니므로 트래픽과 이벤트가 급증할 경우 사용 중인 인프라의 종류에 상관 없이 신속하게, 필요한 만큼의 함수를 복제해 실행할 수 있다.

AWS Lambda는 마이크로프로세스 방식으로 가상 서버를 교체할 수 있으며, 이를 구성하는 인프라 또한 쉽게 분리할 수 있으므로 Lambda 함수와 API Gateway를 이용해 마이크로서비스를 쉽게 구현할 수 있다.

> AWS Lambda 활용하기 위한 기본적인 단계

1. 먼저 AWS Lambda에 ZIP 포맷의 코드를 업로드 한다. 또는 직접 코드를 작성하거나 서버리스 애플리케이션 코드 저장소에서 샘플 코드를 가져온다.
2. 함수에 IAM 롤을 추가하거나 함수에 필요한 새 롤을 생성한다.
3. 함수를 생성한 뒤 Lambda 함수를 호출하기 위한 트리거를 추가한다.
4. Lambda 함수가 비동기적으로 호출되거나 함수가 스트리밍 데이터를 처리하면 목적지에 호출 기록을 전송하도록 목적지의 환경을 설정한다.
5. Lambda 함수가 생성되면 해당 함수가 어느 정도의 주기로 실행될 지 설정할 수 있다. 또한 해당 함수가 이벤트에 의해 실행될지 여부 및 이벤트 소스의 내용도 설정할 수 있다.
6. 사용자는 이벤트 처리를 위한 컴퓨트 리소스, 이벤트 타임아웃, VPC 세부 사항 등 Lambda 함수에 대한 다양한 환경 요소를 설정할 수 있다.

> AWS Lambda 작동 방식

1. AWS Lambda에 코드 업로드
2. AWS 서비스, HTTP 앤드포인트, 인앱 동작 등의 이벤트 발생 시 실행될 코드를 설정
3. Lambda는 이벤트 발생 시 코드를 실행하며, 이때 최소한의 컴퓨팅 리소스만 필요
4. 사용한 컴퓨팅 타임에 따라 비용을 지불

> AWS Lambda가 지원하는 네이티브 언어

1. Java
2. Node.js
3. Python
4. C#
5. Go
6. PowerShell
7. Ruby

또한 AWS Lambda는 함수 작성에 필요한 추가적인 프로그래밍 언어를 지원하는 런타임 API를 제공한다.

> AWS Lambda의 호출별 리소스 용량 제한

AWS Lambda를 사용하기 전에 호출별 리소스 제한 사항을 확인해야 한다.
예를 들어, 사용자가 어떤 코드를 12시간 동안 실행하면 다른 코드는 실행할 수 없게 되는데, 이는 AWS Lambda 의 코드 실행 기간이 요청 당 300초, 즉 최대 5분이기 때문이다.

또한 최대 동시 실행 코드 수는 1000건이지만 이는 다른 AWS 서비스처럼 서포트 티켓으로 상향 조절할 수 있다.

- AWS Lambda의 호출별 리소스 용량 제한

1. 메모리 할당 범위 : 최소 128MB / 최대 3008MB / 최대 메모리 사용량 초과 시 Lambda 함수 실행 종료됨
2. 임시 디스크 용량 : 512MB
3. 파일 디스크립터 수 : 1024
4. 프로세스와 스레드의 수 : 1024
5. 요청당 최대 실행 기간 : 300초
6. Lambda 함수 배포 패키지 크기 : 50MB
7. 리전 당 업로드 할 수 있는 배포 패키지의 총 용량 : 75GB

> Lambda 사용 패턴

Lambda는 Amazon S3, DynamoDB, Amazon Kinesis Data Streams, Amazon SNS, Amazon CloudWatch 등 다양한 AWS 서비스에 의해 직접 실행될 수 있으며, 
이들 서비스를 활용해 다양한 실시간 데이터 처리 시스템을 구현할 수 있다.

다음은 실무적으로 Lambda를 사용하는 가장 대표적인 패턴이다,

- 실시간 파일 데이터 처리
: Lambda를 통해 Amazon S3에 업로드된 파일 또는 수정된 파일을 처리할 수 있다. 예를 들어, Amazon S3에 업로드 된 컬러 이미지를 그레이스케일 이미지로 변환할 수 있다.

- 실시간 스트림 데이터 처리 
: Kinesis Data Streams 와 Lambda를 이용해 스트리밍 데이터 처리, 클릭 스트림 분석, 로그 필터링, 소셜 미디어 분석 등의 작업을 수행할 수 있다.

- ETL(Extract, Transform, Load) 작업
: 하나의 저장소에 있는 데이터 추출, 변환한 뒤 또 다른 저장소에 로딩할 수 있다.

- Cron 대체
: 스케줄 표현식을 사용해 일정한 주기로 Lambda 함수를 실행할 수 있으며, 이는 EC2 인스턴스에서 크론을 사용하는 경우보다 저렴하고 가용성도 높은 방식이다.

- AWS Events 처리
: Amazon S3에 로그인하거나 S3 버킷 알림을 이용해 Lambda 함수를 실행할 때, AWS CloudTrail 등 다른 서비스를 이벤트 소스로 이용할 수 있다.

### Amazon API GateWay

API 아키텍처 구현, 배포, 유지, 모니터링 작업은 많은 시간이 소요되는 까다로운 작업이며 API 관련 업무를 지속적으로 개선하는 일은 훨씬 더 어렵다.
Amazon API Gateway는 이와 같은 문제를 해결하는 것은 물론 레스트풀 API 개발 및 유지를 위한 운영 업무를 줄여준다.

Amazon API Gateway는 API 정의, 퍼블리싱, 배포, 유지, 모니터링, 확장에 이르는 모든 업무를 안전하게 처리할 수 있도록 하는 완전 관리형 API 서비스이며,
클라이언트는 표준 HTTPS 요청을 통해 해당 API를 통합할 수 있다.

아울러 API Gateway는 Amazon EC2, ECS, AWS Lambda, 온프레미스 환경에서 실행되는 모든 웹 애플리케이션과 연결할 수 있는 창구로서의 역할을 수행해 데이터, 비즈니스, 로직, 백엔드 기능 등에 신속하게 접근할 수 있다.

API Gateway는 기업의 비즈니스 로직과 고객을 API로 연결할 수 있는 강력한 기능을 제공하며, 주요 활용 방식은 다음과 같다.

- 백엔드 HTTP 엔드포인트, AWS Lambda 함수 또는 기타 AWS 서비스에 연결하기 위한 레스트풀 API의 생성, 배포, 관리
- 프론트엔드 HTTP 엔드포인트를 통해 외부로 노출된 API 호출

API Gateway는 수십만 개에 이르는 동시적 API 호출을 처리하기 위한 제반 업무를 수행하며, API 관리를 위한 모든 문제 또한 대신 처리할 수 있다.

예를 들어, API Gateway 트래픽 관리 기능을 이용해 접근 권한 부여 및 접근 제어, 트래픽 모니터링, 버전 컨트롤 업무를 수행한다.

사용자는 API 호출 및 전송된 데이터의 양에 따라 비용을 지불하며 기본 요금 또는 기본 설치 비용을 부담할 필요가 없다.

> API Gateway가 지원하는 API 유형

API Gateway가 지원하는 API 유형은 다음과 같다.

- REST API 
: REST API는 API 프록시 기능 및 API 관리 기능을 단일 솔루션으로 제공한다. REST API는 사용량 계획, API 키, API 배포 및 수익화 등 다양한 API 관리 기능을 제공한다.

- WebSocket API
: WebSocket API 를 이용해서 클라이언트와 지속형 연결 유지할 수 있으며, 이를 통해 실시간 메시지 커뮤니케이션 기능을 구현할 수 있다.

- HTTP API 
: HTTP API는 AWS Lambda 함수 또는 HTTP 백엔드의 프록시 역할을 하는 API 구현에 최적화돼 있으며, 이를 통해 서버리스 워크로드를 효과적으로 처리할 수 있다.

> Amazon API Gateway의 장점

Amazon API Gateway의 주요 장점은 다음과 같다.

- 높은 성능 및 장애 대응성
: 백엔드 성능 증감을 통해 트래픽 폭증 상황에도 유연하게 대처할 수 있으며, 사용자는 API Gateway 운영 인프라에 대한 관리 부담없이 필요한 만큼의 인프라 리소스를 활용할 수 있다.

- 캐싱 기능
: API 출력 데이터의 캐싱 기능을 통해 API 호출 성능을 향상 시키고, 응답 지연 가능성을 감소시켜서 사용자 경험 수준을 높일 수 있다.

- 보안성
: API 접근 권한 관리 및 서비스 운영에 대한 접속 제한 기능을 통해 보안성을 유지하고, AWS IAM, Amazon Cognito 등과 같은 AWS 전용 도구를 이용해 API 접속 권한을 관리할 수 있다.
또한 AWS 최신의 서명 관리 프로토콜인 Signature Version 4가 적용된 서명된 API 호출에 대한 검증 기능도 제공한다.

- 이용량 측정
: 서드 파트 개발자의 API 사용량을 측정하고 접근을 제한하는 기능을 제공한다. API에 대한 요청을 자동으로 측정하고 관련 데이터를 API 키 별로 추출할 수 있다.

- 모니터링
: API를 배포한 뒤 API Gateway 대시보드를 통해 API 호출과 관련된 모든 지표를 확인하고 모니터링 할 수 있으며, Amazon CloudWatch와 통합해 API 호출, 응답 지연, 오류 발생률 등 모든 통계 지표를 확인할 수 있다.

- 라이프 사이클 관리
: 동일한 API의 다양한 버전을 간편하게 관리할 수 있으며, 개발자는 이를 이용해서 개발 단계, 상용화 단계, 베타버전 단계 등 서비스 개발 단계에 따라 존재하는 다양한 버전을 효율적으로 배포할 수 있다.

- 다른 AWS 서비스와의 통합
: AWS Lambda와 통합해 서버리스 API를 구현할 수 있고, Amazon CloudFront와 통합해 DDos 공격을 효과적으로 방버할 수 있다.

- Open API 명세서 지원 
: Swagger는 오픈소스 기반 API 개발 도구이며, API 생성 및 배포, 업데이트 등의 기능을 포함한 Swagger 임포트 도구를 이용해 Swagger API 정의 템플릿을 Amazon API Gateway로 임포트할 수 있다.

- IOS, Android, JavaScript용 SDK 지원
: API Gateway는 사용자의 API 정의 내역에 따라 자동으로 클라이언트 SDK를 생성하며, 개발자는 이를 이용해서 API에 대한 기본 설계부터 통합 테스트에 이르는 업무를 불과 몇 시간만에 마칠 수 있다.

* Amazon API Gateway는 비교적 최근에 시험 영역에 추가됐으며, API Gateway 활용 방식, API Gateway의 활용에 따른 장점을 잘 이해해야 한다.

Lambda는 API Gateway와 쉽게 통합할 수 있다. 특히 API Gateway와 Lambda를 조합해 완벽한 서버리스 애플리케이션을 만들 수 있다.

### Amazon Kinesis 

지난 수년간 비즈니스에서 활용할 수 있는 데이터의 양이 급증했으며, 최근에는 특히 다양한 원천으로부터 막대한 양의 실시간 데이터가 유입되고 있다.

데이터에서 인사이트를 얻으려면 신속하게 데이터를 처리하고 분석할 수 있어야 하며, 이와 같은 데이터 수집, 처리, 분석 능력은 기업이 고객에게 제공하는 서비스의 수준을 결정 지을 수 있으므로 매우 중요하다.

예를 들어, 고객 구매 행동과 관련해 기업은 데이터 분석을 통해 광고 메시지를 변경하거나 고객 구매 행동 패턴을 반영해 상품을 추천할 수 있다.

> 실시간 애플리케이션 시나리오

스트리밍 데이터 기반의 애플리케이션 활용 시나리오는 크게 두 가지로 생각해 볼 수 있다.

1. 배치 분석에서 스트리밍 분석으로 진화

배치 프로세싱은 전통적인 데이터 분석 방식이다. 기존의 데이터웨어하우스 또는 하둡프레임워크의 일괄처리 방식이며, 데이터 레이크, 데이터 사이언스, 머신러닝 분야에서 주로 사용한다.
반면 스트리밍 프로세싱은 실시간으로 흘러가는 데이터를 지속적으로 분석하는 방식으로 데이터 레이크에 쌓인 상태에서가 아닌 데이터 레이크에 유입될 때 해당 데이터를 처리한다.
스트리밍 분석 방식은 새로운 데이터를 통해 기존의 머신러닝 모델을 좀 더 자주 업데이트할 수 있으며, 분석 결과를 좀 더 정확하고 신뢰할 수 있게 해준다.
미국의 부동산 정보업체 질로우의 경우 Amazon Kinesis Data Streams 서비스를 이용해 부동산 관련 공공 데이터를 수집해 부동산 구매자와 판매자에게 실시간에 가깝게 해당 부동산의 가격을 제시한다.
또한 처리 및 분석한 데이터를 S3 데이터 레이크에 저장해 최신의 부동산 정보를 질로우 애플리케이션에 배포한다.

2. 실시간 애플리케이션 개발

스트리밍 데이터 서비스는 애플리케이션 모니터링, 사기행동 감지, 라이브 리더보드 등 실시간 애플리케이션에 사용할 수 있다. 
이를 위해서는 데이터 수집부터 처리까지 밀리초 수준의 지연만 허용돼야 하며, 처리된 데이터는 타깃 데이터 스토어와 기업의 다른 시스템에 빠짐없이 전송돼야 한다.
VOD 서비스 전문 기업인 넷플릭스의 경우 Kinesis Data Streams을 이용해 모든 애플리케이션과의 커뮤니케이션 상태를 모니터링하고, 
문제가 발생할 경우 신속하게 탐지 및 해결하며, 전 세계의 모든 시청자가 연중 중단없이 콘텐츠를 시청할 수 있도록 한다.
실시간 데이터 분석은 기존에는 주로 애플리케이션 성능 모니터링에 활용됐지만 최근에는 광고 기술, 게임 페블리싱, IoT 등으로 적용분야가 넓어지고 있다.

> 배치 데이터 처리와 스트리밍 데이터 처리의 차이점

배치 데이터와 스트리밍 데이터는 데이터 수집, 정련, 처리, 분석을 위한 도구가 다르다.

배치 분석의 경우 데이터 수집, 데이터베이스 입력, 분석까지 적게는 수 시간, 많게는 수 주의 시간이 소요되는 일괄 처리 방식을 사용하지만 실시간 데이터는 이런 방식으로 분석할 수 없기 때문이다.

스트리밍 데이터 처리의 경우 데이터베이스에 저장된 데이터를 쿼리하는 방식이 아닌 실시간으로 연속 처리해야 정보로서의 가치를 지니게 되며, 유입되는 정보량 또한 언제든 급증 또는 급감할 수 있다.
따라서 스트리밍 데이터 처리 플랫폼은 유입 데이터의 속도와 다양성에 맞춰 유연하게 작동해야 하며 시간당 유입되는 수백만에서 수십억 건의 이벤트를 신속하게 처리할 수 있어야 한다.

실시간 데이터 분석 서비스인 Amazon Kinesis는 대량의 데이터를 효과적으로 처리해 사용자에게 해당 데이터가 지닌 인사이트를 제공한다.
Amazon Kinesis 패밀리는 다음과 같다.

- Amazon Kinesis Data Streams
- Amazon Kinesis Data Firehose
- Amazon Kinesis Data Analytics
- Amazon Kinesis Video Streams

### Amazon Kinesis Data Streams

Amazon Kinesis Data Streams는 특화된 분석 목적에 맞춰 스트리밍 데이터에 대한 실시간 분석 서비스를 제공하며 
웹 사이트 클릭스트림, 신용카드 사용 등 금융 거래, 소셜미디어 피드, IT 로그, 위치 추적 이벤트 등 수십만 가지의 데이터 소스로 유입되는 테라 바이트 급 데이터를 저장 및 처리할 수 있다.

KCL(Kinesis Client Library) 은 스트리밍 데이터를 이용해 실시간 대시보드, 실시간 경고, 동적 가격 책정 및 광고 집행과 같은 기능을 수행하는 Kinesis 애플리케이션의 구현을 돕는 라이브러리다.

사용자는 Kinesis Data Streams 에서 실시간으로 수집한 데이터를 Amazon S3, Redshift, EMR, AWS Lambda 등의 서비스에 전송할 수 있다.

> Amazon Kinesis Data Streams 장점

Amazon Kinesis Data Streams 의 장점은 다음과 같다.

- 실시간성 
Kinesis Data Streams의 가장 주요한 장점은 실시간 데이터 처리이며, 데이터 생성 즉시 해당 데이터를 수집해 중요한 정보를 기업의 비즈니스 또는 운영 부문에 신속하게 전달할 수 있다.

- 안전성
사용자는 VPC 엔드포인트를 이용해 안전하게 Kinesis Data Streams API에 접속할 수 있고, 보안 규정 준수를 위해 서비스에 내장된 서버 측 암호 기능을 사용하거나 AWS KMS의 마스터 키를 이용할 수 있다.

- 편리성
데이터 분석을 위한 Kinesis 스트림은 거의 즉각적으로 생성할 수 있고, KPL를 이용해 간편하게 스트림 데이터를 입력할 수 있으며, KCL을 이용해 실시간 데이터 처리 애플리케이션을 만들 수 있다.
Kinesis Data Streams 프로듀서는 Kinesis 스트림에 대한 사용자 데이터 입력을 지원하는 애플리케이션이며, KPL은 이와 같은 프로듀서 애플리케이션의 개발을 간소화하고, Kenisis 스트림을 위한 고도의 쓰기 연산 성능을 제공한다.

- 병렬처리
다수의 Kinesis 애플리케이션을 이용해 동일 스트림을 동시간적으로 처리할 수 있다. 
예를 들어, 동일한 스트림 처리를 위한 두 개의 Kinesis 애플리케이션이 있을 때 하나는 실시간 데이터 분석에 사용하고, 다른 하나는 S3에 전송 및 저장하는 용도로 사용할 수 있다.

- 탄력성
Kinesis Data Streams의 처리 성능을 시간당 수 메가바이트에서 수 테라바이트로 올릴 수 있고, 초당 PUT 기록 처리량은 수천에서 수백만으로 올릴 수 있다.
사용자는 입력 데이터의 크기에 따라 즉각적으로 스트림 데이터의 처리 성능을 동적으로 조절할 수 있다.

- 저비용
초기 설치비 및 고정비가 없으며, 사용자는 리소스 사용비만 부담하면 된다.

- 신뢰성
Kinesis Data Streams는 AWS 리전 내 세 개의 시설에 스트리밍 데이터를 동기적으로 복제해 7일간 보존한다.
따라서 애플리케이션 오류, 서버 작동 오류, 시설 문제등으로 발생할 수 있는 데이터 손실 가능성을 줄일 수 있다.

### Amazon Kinesis Data Firehose

Amazon Kinesis Data Firehose는 데이터 저장소와 분석 도구에 스트리밍 데이터를 로딩하기 위한 가장 간단한 방법을 제공하며, 스트리밍 데이터를 수집, 변환해 Amazon S3, Redshift, Elasticsearch, Splunk 등에 로딩할 수 있다.

아울러 기존 비즈니스 인텔리전스 도구 및 대시보드와 결합해 근실시간 분석이 가능하도록 한다.

Kinesis Data Firehose는 관리자에 의한 지속적인 관리가 필요 없고, 요구 처리 성능에 따라 자동으로 확장되는 완전관리형 서비스로 데이터 로딩 전 데이터 배치, 압축, 암호화를 시행해 전송 용량을 최소화하고 보안 수준을 높인다.

Amazon Kinesis Data Firehose는 스트리밍 데이터를 로딩하기 위한 스토리지, 네트워킹, 환경 설정 등 모든 인프라를 관리한다. 따라서 사용자는 Amazon S3, Redshift, Elasticsearch 또는 Splunk에 데이터 로딩만 하면 되고,
이를 위한 하드웨어 및 소프트웨어 프로비저닝, 배포, 유지보수 등의 업무에 신경 쓸 필요가 없다.

Firehose는 관리자의 운영 또는 개발자의 개발 지원 없이 요구 성능에 따라 탄력적으로 확장할 수 있으며, 동일 AWS 리전 내의 세 개 시설에 동기적으로 데이터 복제해 전송하려는 데이터의 고가용성, 고신뢰성을 유지한다.

> Amazon Kinesis Data Firehose 의 장점

Kinesis Data Firehose의 장점은 다음과 같다.

- 사용편리성

사용자는 AWS 관리 콘솔에서 클릭 몇 번 만으로 Kinesis Data Firehose에서 스트리밍 데이터를 수집하고 로딩할 수 있다.
Firehose 전송 스트림을 생성한 뒤, 전송 대상을 선택하면 수십만 개의 데이터 소스로부터 동시에 데이터를 가져올 수 있다.
Firehose는 데이터 로딩을 위한 스케일링, 샤딩, 모니터링 등, 일체의 스트리밍 데이터 로딩 업무를 자동으로 처리한다.

- AWS 데이터 저장 서비스와 통합

Kinesis Data Firehose는 S3, Redshift, Elasticsearch 등 AWS 저장 서비스와 통합해서 사용할 수 있다.
사용자는 AWS 관리 콘솔을 통해 Firehose 스트림 데이터를 S3 버킷, Redshift 테이블 또는 Elasticsearch 도메인에 직접 로딩한 뒤 스트리밍 데이터 분석 도구에서 바로 분석할 수 있다.

- 서버리스 데이터 변환

데이터 저장소로 로딩하기 전 스트리밍 데이터를 적절한 형식으로 가공 및 변환할 수 있으며, 다양한 데이터 소스에서 수집한 데이터를 별도의 데이터 처리 파이프라인 없이, 대상 데이터 스토어가 요구하는 포맷으로 변환할 수 있다.

- 근실시간

Firehose는 근실시간 처리 성능을 제공하며, S3, Redshift, Elasticsearch, Splunk 등으로 전송된 데이터를 60여초 이내에 로딩할 수 있다. 따라서 좀 더 신속하게 새로운 데이터에 접근헤 비즈니스 또는 운영 이벤트에 대응할 수 있다.

- 지속적 관리 필요 없음

Firehose는 프로비전, 관리, 컴퓨팅, 메모리, 네트워크 리소스 확장 등 스트리밍 데이터 로딩에 필요한 모든 업무를 자동으로 처리하는 완전 관리형 서비스다. 한 번 설정하고 나면 유입되는 데이터를 지정된 대상에 지속적으로 로딩할 수 있다.

- 사용량에 따른 과금

사용자는 기본료 또는 약정료 부담 없이 자신이 전송한 데이터 볼륨의 양에 따른 비용만 부담한다.

### Amazon Kinesis Data Analytics

Amazon Kinesis Data Analytics는 실시간성의 스트리밍 데이터를 처리 및 분석하기 위한 가장 간단한 방법이며, 표준 SQL 방식을 사용하므로 별도의 분석용 프로그래밍 언어를 학습할 필요가 없다.

Analytics의 사용법은 매우 간단해서 데이터 스트림이 유입되면 사용자는 SQL 쿼리를 작성해 분석 결과를 로딩할 장소만 지정하면 된다.

Analytics는 사용자를 대신해 SQL 쿼리 처리를 위한 지속적인 데이터 입출력 업무를 담당하며, 결괏값이 나오면 지정한 대상에 전송한다.

> Amazon Kinesis Data Analytics 의 장점

Amazon Kinesis Data Analytics 의 장점은 다음과 같다.

- 강력한 실시간 처리 성능

Kinesis Data Analytics는 스트리밍 데이터 처리시 1초미만의 처리 지연 성능을 제공해 실시간으로 분석 및 대응할 수 있도록 하며, 이상점 감지, top-K 분석 등을 위한 스트리밍 데이터 처리를 위한 내장 함수를 제공한다.

- 완전관리형

서비스 스트리밍 애플리케이션 실행을 위해 사용자가 프로비전, 인프라 관리 등의 업무를 할 필요가 없는 완전관리형 서비스다.

- 자동화된 탄력성

분석 인프라에 대한 자동화된 스케일업과 스케일다운 기능을 제공하므로 스트리밍 애플리케이션의 분석 처리 지연 시간을 최소화 할 수 있다.

- 사용 편의성

구조화 및 비구조화 스트리밍 데이터 분석을 위한 스킴 에디터, SQL 에디터, SQL 템플릿 등 상호작용성 높은 분석 도구를 제공한다.

- 표준 SQL 

Kinesis Data Analytics 는 표준 SQL을 지원하므로 별도의 프로세싱 프레임워크나 프로그래밍 언어를 학습할 필요가 없다.

- 사용량에 따른 과금

사용자는 스트리밍 애플리케이션이 사용하는 프로세싱 리소스에 대한 비용만 부담한다. 

> Amazon Kinesis Data Analytics 의 사용 시나리오

수 일 또는 수 주일 후가 아닌 수 분, 수 초 이내에 해당 데이터가 지닌 인사이트를 알고 싶다면 Kinesis Data Analytics가 도움을 줄 수 있다.

가장 대표적인 세 가지 사용 시나리오로 시계열 분석, 실시간 대시보드, 노치피케이션이 있다.

- 시계열 분석

시계열 분석(Time-series analytics)은 특정 데이터의 시간 흐름에 따른 변화를 모니터링하고 이해하기 위한 것이며, Kinesis Data Analytics는 SQL 코드를 통해 특정 기간 동안 시계열 분석을 수행한다.

- 실시간 대시보드

쿼리 결과의 연산을 수행하고 그 결과를 대시보드에 출력해 근실시간으로 유입 데이터를 시간화하는 애플리케이션 개발에 Kinesis Data Analytics를 사용할 수 있다.

- 실시간 경고 및 알림

특정 성능 지표가 미리 정한 한곗값에 도달하면 실시간 경고 및 알림을 생성하는 애플리케이션을 구현하거나 머신러닝 알고리즘을 이용한 이상행동 감지 애플리케이션을 구현하는 데 Kinesis Data Analytics를 사용할 수 있다.

### Amazon Kinesis Video Streams

* 시험범위에 포함되지 않는다....? * 

Kinesis Video Streams은 완전 관리형 서비스로 미디어 파일의 포뱃별 입력, 처장, 용도별 처리 등에 활용되며, 사용자는 어떤 크기의 미디어 파일이라도 문제 없이 처리할 수 있다. 

관리형 서비스이므로 관련된 어떤 인프라도 여러분이 직접 프로비전할 필요가 없으며,요구사항에 따라 자동으로 인프라가 확장 또는 축소될 수있다.

### 서버리스 서비스 활용을 위한 아키텍처 참고 사례

> 실시간 파일 처리

Amazon S3에 대한 파일 업로드를 이벤트로 해 AWS Lambda 함수를 실행할 수 있다.

> 실시간 스트리밍 데이터 처리

AWS Lambda와 Amazon Kinesis를 이용해 애플리케이션 활동 트래킹, IoT 디바이스 데이터 수신 및 측정 등 실시간 스트리밍 데이터를 효과적으로 처리할 수 있다.

> 데이터 웨어하우스를 위한 추출, 변환, 로딩(ETL) 처리

AWS Lambda를 이용해 DynamoDB에 저장된 데이터 검증, 필터링, 분류, 각종 변환 업무를 수행한 뒤 이를 다른 데이터 저장소에 로딩할 수 있다.

> IoT 백엔드 구현

AWS Lambda를 이용해 웹, 모바일, IoT, 서드 파트 API 요청을 처리하는 백엔드용 서비리스 아키텍처를 구현할 수 있다.

### Amazon CloudFront

Amazon CloudFront는 글로벌 CDN 서비스로 저지연성과 고속 전송 속성을 지닌 콘텐츠 배포 기능을 제공하며, 콘텐츠 사용자과 가까운 지역에 네트워크 망을 구축하고 지역별 엣지 캐시를 통해 사용자 경험 수준을 높여 준다.
Amazon CloudFront는 정적 콘텐츠는 물론, 동적 콘텐츠도 지원하며 사용자의 요청은 가장 가까운 엣지 로케이션에서 처리된다.

> Amazon CloudFront의 활용 시나리오

1. 정적 콘텐츠 캐싱 
- 사진, 동영상, 스타일시트, 자바스크립트 등의 정적 콘텐츠 전송 속도를 높여줌

2. 동적 콘텐츠
- 가속화 네트워크 최적화를 통한 동적 콘텐츠 가속화 기능을 제공

3. DDos 공격 대응

4. 강화된 보안성

5. API 호출 가속화

6. 소프트웨어 배포

7. 비디오 스트리밍

> Amazon CloudFront 핵심 개념

1. 엣지 로케이션

엣지 로케이션이라 부르는 글로벌 데이터 센터 네트워크를 통해 콘텐츠를 배포한다.

2. 지역별 엣지 캐시

지역별 엣지 캐시는 오리진 웹 서버와 엣지 로케이션 사이에 위치해 사용자에게 직접 콘텐츠를 전송한다.

3. 배포

원본 파일의 위치를 나타내는 CloudFront 경로로 CloudFront.net 도메인 네임으로 표시되며, 글로벌 엣지 로케이션에서 사용자의 객체 참조 시 사용할 수 있다.

배포 시 사용자 지정 도메인 네임을 쓸 수 있고 HTTP 또는 HTTPS 프로토콜을 이용해 사용자에게 콘텐츠 다운로드 경로를 제공하거나, RTMP 프로토콜을 이용해 콘텐츠 스트리밍 서비스를 제공할 수 있다.

4. 오리진

CloudFront는 S3, HTTP 서버, ELB 또는 ALB, AWS 외부의 커스텀 오리진 서버를 통해 접근할 수 있다.

5. 제어 동작

CDN과 관련된 정책의 적용, 요청 타입에 따른 반응 변경, 객체의 캐싱 기능 조절 등 CloudFront의 세부적인 제어 동작을 의미한다.

> Amazon CloudFront 주요 제어 동작

1. 경로 패턴 매칭
2. 헤더
3. 쿼리 문자열 및 쿠키
4. 서명 URL 및 서명 쿠키
5. 프로토콜 정책
6. 유지시간
7. gzip 압축

> 지역 제한 기능

사용자가 콘텐츠에 대한 요청을 하면 CloudFront는 사용자의 위치에 상관없이 콘텐츠를 전송한다.

특정 국가의 콘텐츠 요청을 거부하려면 다음과 같은 지역 제한 기능을 사용하면 된다.

- 접속 허용 국가 목록인 화이트 리스트 기반으로 요청 콘텐츠에 대한 접근을 허용하는 방법
- 접속 금지 국가 목록인 블랙 리스트를 기반으로 요청 콘텐츠에 대한 접근을 거절하는 방법

> 오류 처리 기능

콘텐츠 요청에 대해 오리진 서버가 HTTP 4xx 또는 5xx 상태코드를 반환하면 사용자에게 커스텀 오류 페이지를 제공할 수 있다.










